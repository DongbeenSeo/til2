## 브라우저 렌더링 과정

> ref)
> https://vallista.kr/2019/05/06/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EB%A0%8C%EB%8D%94%EB%A7%81-%EA%B3%BC%EC%A0%95/#%EB%8F%99%EC%9E%91-%EA%B3%BC%EC%A0%95
> https://jeong-pro.tistory.com/90

1. 불러오기
   로더(Loader)가 서버로부터 전달 받는 리소스 스트림을 읽는 과정.
   읽으면서 어떤 파일인지, 데이터인지 파일을 다운로드 할 것인지 등을 결정한다.

2. DOM 트리 구축을 위한 HTML 파싱
   웹 엔진이 HTML 문서를 받아서 파싱하고 컨테츠 트리 내부에서 태그(a, div)를 DOM(Document Object Map)노드로 변환한다. 그 다음 CSS파일과 함계 포함된 스타일 요소를 파싱한다. 스타일 정보와 HTML표시 규칙들은 REnder Tree라고 부르는 또 다른 트리를 생성한다.
3. 렌더 트리 구축
   HTML과 CSS를 파싱해서 만들어진 렌더 트리는 색상 또는 면적 등의 시각적 속성을 갖고 있는 사각형을 포함하고 있다. 정해진 순서대로 렌더링 하게 된다.

4. 렌더 트리 배치
   렌더 트리 생성(구축)이 끝나면 배치가 시작된다. 각 노드가 정확한 위치에 표시되기 위해 이동한다.

5. 렌더 트리 그리기
   배치를 완료하면 UI백엔드에서 각 노드를 가로지르며 Paint작업을 한다.

### CSS는 위에 Script는 아래에

웹 브라우저의 렌더링 순서를 이해하면 문서를 파싱해서 DOM Tree를 만들어도 스타일 규칙이 없으면 렌더링 할 수 가 없다.

즉 최대한 빨리 스타일 규칙을 아아야 렌더링 트리가 완전히 만들어지므로 스타일시트 파일을 모두 다운로드 시키기 위해 `<head></head>`태그 사이에 놓는 것이다.

자바스크립트는 DOM객체를 이용해서 컴포넌트들을 조작하는데 `<head></head>`태그 사이 처럼 상단에 놓게 되면 HTML 파서가 파싱을 멈추고 스크립트파일을 읽기 때문에 아래에 놓아야 성능이 좋아진다.

파싱을 멈추고 읽기 때문에 위에서 스크립트파일이 많거나 파일이 크면 읽는 시간이 오래걸려 사용자 입장에서 웹페이지가 느리게 보이게 되므로 느리다고 느낄 수 있다.

- 또 하나의 렌더링 최적화 방법으로 초기 렌더링때 AJAX요청을 최소화 하는 방법이 있다.
  초기에 HTML은 화면을 구성하는 레이아웃만 있고 실제데이터는 AJAX요청을 통해 나중에 받아온다면 1차적으로 렌더링이 끝나고 나서 AJAX로 가져온 데이터로 다시 2차적 렌더링을 하게 되므로 느려보인다.
  따라서 초기 렌더링대는 AJAX요청을 최소화 해야한다.
